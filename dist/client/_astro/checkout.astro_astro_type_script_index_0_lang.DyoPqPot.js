import{$ as g,c as f}from"./cartStore.DRyQvXMF.js";import"./index.daetGfa_.js";const d=document.getElementById("order-items"),c=document.getElementById("subtotal-display"),a=document.getElementById("delivery-label"),u=document.getElementById("delivery-cost"),y=document.getElementById("total-display"),m=document.getElementById("checkout-form"),v=document.querySelectorAll('input[name="delivery"]');let i={},o=0,n=250;function p(){const r=o+n;c&&(c.textContent=`Rs ${o}`),u&&(u.textContent=`Rs ${n}`),y&&(y.textContent=`Rs ${r}`)}v.forEach(r=>{r.addEventListener("change",t=>{t.target.value==="normal"?(n=250,a&&(a.textContent="Delivery (Normal)")):(n=400,a&&(a.textContent="Delivery (Express)")),p()})});g.subscribe(r=>{if(i=r,!d)return;const t=Object.values(r);o=0,d.innerHTML=t.map(e=>(o+=e.price*e.quantity,`
        <div class="flex justify-between items-start">
          <div>
            <p class="text-sm font-medium text-gray-800 dark:text-neutral-200">${e.title}</p>
            <p class="text-sm text-gray-500 dark:text-neutral-400">Qty ${e.quantity} x Rs ${e.price}</p>
          </div>
          <span class="text-sm font-medium text-gray-800 dark:text-neutral-200">Rs ${e.price*e.quantity}</span>
        </div>
      `)).join(""),p()});m&&m.addEventListener("submit",async r=>{if(r.preventDefault(),Object.keys(i).length===0){alert("Your cart is empty!");return}const t=new FormData(r.target),e={customerName:t.get("full-name"),customerEmail:t.get("email"),customerPhone:t.get("phone"),shippingAddress:t.get("address"),shippingCity:t.get("city"),shippingPostalCode:t.get("postal-code"),shippingCountry:t.get("country"),deliveryMethod:t.get("delivery"),paymentMethod:t.get("payment"),orderNotes:t.get("notes"),items:Object.values(i),subtotal:o,deliveryCost:n,total:o+n};try{const s=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),l=await s.json();s.ok?(f(),window.location.href=`/thank-you?orderNumber=${l.orderNumber}`):alert(`Order failed: ${l.error}`)}catch(s){console.error("Order submission error:",s),alert("Failed to place order. Please try again.")}});
